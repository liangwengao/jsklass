!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";var n=function(n){return"array"===C(n)},t=function(n){var t=!!n&&"length"in n&&n.length,e=C(n);return"function"!==e&&!A(n)&&("array"===e||0===t||"number"==typeof t&&t>0&&t-1 in n)},e=function(n,t){return $(t,function(t,e){n.push(e)}),n},r=Object.freeze({isArray:n,isArrayLike:t,mergeArray:e}),i=function(n){return"string"===C(n)},o=function(n){throw new Error(n)},c=function(n,t){j(n)||j(t)?console.error(n):console.error(n,t)},u=function(n,t){j(n)||j(t)?console.warn(n):console.warn(n,t)},f=function(n,t){j(n)||j(t)?console.info(n):console.info(n,t)},a=function(n,t){j(n)||j(t)?console.log(n):console.log(n,t)},s=Object.freeze({exit:o,error:c,warn:u,info:f,log:a}),l=function(n){return"function"===C(n)},p=function(n){try{return new Function("return "+n)()}catch(n){o(n)}},_=Object.freeze({isFunction:l,evil:p}),d=function(n){return"object"===C(n)},v=function(n,t){return $(t,function(t,e){n[t]=e}),n},m=function(n,t){return $(t,function(e,r){t.propertyIsEnumerable(e)&&(n[e]=r)}),n},y=function(n){try{if(i(n)){var t=JSON.parse(n);return!(!d(t)||!t)}if(d(n)){var e=JSON.stringify(n);return!(!i(e)||!e)}}catch(n){return!1}},b=function(n,t){var e=!1;return y(n)&&i(t)?($(n,function(n,r){if(n===t)return e=!0,!1}),e):e},g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},h={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error","[object Symbol]":"symbol"},O=h.toString,S=(h.hasOwnProperty.toString.call(Object),function n(t,e){try{if(e=e||[],!t||!e||e.length<=0)return t;var r=t[e.shift()];return e.length>0?n(r,e):r}catch(n){return""}}),C=function(n){return null===n?n+"":"object"===(void 0===n?"undefined":g(n))||"function"==typeof n?h[O.call(n)]||"object":void 0===n?"undefined":g(n)},j=function(t){if(void 0===t||null===t||""===t||void 0===t)return!0;if(n(t)||d(t)){var e=0;for(var r in t)e++;if(e<=0)return!0}return!1},w=function(n,t,e){if(e=e||"",n=d(n)?n:{},j(t)||d(t))return e;var r=t.split("."),i=S(n,r);return j(i)?e:i},$=function(n,e){var r=void 0,i=0;if(t(n))for(r=n.length;i<r&&!1!==e.call(n[i],i,n[i]);i++);else for(i in n)if(!1===e.call(n[i],i,n[i]))break;return n},x=function(n,e){var r=void 0;if(t(n))for(var i=(r=n.length)-1;i>=0&&!1!==e.call(n[i],i,n[i]);i--);else{var o=[];$(n,function(n,t){o.push(n)}),o.sort(function(n,t){return t-n});var c=function(t){var e={};return $(n,function(n,r){if(n.toString()===t.toString())return e=r,!1}),e};$(o,function(n,t){if(!1===e.call(c(t),t,c(t)))return!1})}return n},I=function(n){return Object.seal(n)},L=function(n){return Object.freeze(n)},A=function(n){return void 0!==n&&n===n.window},V=function(){return"undefined"!=typeof window},G=[],k="",z=function n(){for(var t=[],e="0123456789abcdef",r="",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);return t[14]=e.substr(Math.ceil(Math.random()*e.length),1),t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",r=t.join(""),G.indexOf(r)>-1?n():(G.push(r),r)},E=function(){if(j(k)){for(var n=[],t=0;t<8;t++)n[t]="0123456789ABCDEF".substr(Math.floor(16*Math.random()),1);k=n.join("")}return k},F=function(n,t){var e=function n(t,e){if(!e&&!l(e))return t;if(t=t.concat(e.constructor||e),e._vd_){var r=e._vd_.getSuper(E());if(!j(r))return n(t,r)}return t};this.handle=function(){return e(n,t)}},P=function(n,t){var r=function n(t,r){if(!r&&!l(r))return i(t);if(r._vd_){var o=r._vd_.getInterfaces(E()),c=r._vd_.getSuper(E());if(t=e(t,o),!j(c))return n(t,c)}return i(t)},i=function(n){var t=[];return $(n,function(n,e){t.indexOf(e)<0&&t.push(e)}),t};this.handle=function(){return r(n,t)}},T=["class_name","super_class_name","interface_name","static","super","prototype","constructor","lifetime_uid","_vd_","instanceOfInterface","instanceOfClass","$class_name","$super_class_name","$interface_name","$static","$super","$prototype","$constructor","$lifetime_uid","$_vd_","$instanceOfInterface","$instanceOfClass"],N=["class_name","super_class_name","interface_name","super","prototype","constructor","lifetime_uid","_vd_","instanceOfInterface","instanceOfClass","$class_name","$super_class_name","$interface_name","$super","$prototype","$constructor","$lifetime_uid","$_vd_","$instanceOfInterface","$instanceOfClass"],J=function(n,t){var e=/^[a-zA-Z0-9_$]+$/i,r=[],i=[],c=[],u="",f="prototype",a=!1,s=!1,l=!1,p=!1,_=!1;return $(t,function(n,t){var o=t.self,d=t.prototype,v=t.static,m=t.const;return $(d,function(n,t){if("_construct"===n)return u=n,f="prototype",s=!0,!1;if("$_construct"===n)return u=n,f="prototype",a=!0,!1;if(N.indexOf(n)>-1)return u=n,f="prototype",l=!0,!1;if(Z(n)){var e=M(n);if(r.indexOf(e)>-1)return u=e,f="prototype",_=!0,!1;r.push(e)}else if(r.indexOf(n)>-1)return u=n,f="prototype",_=!0,!1}),!(_||l||a||s)&&($(o,function(n,t){if("$_construct"===n)return u=n,f="self",a=!0,!1;if(N.indexOf(n)>-1)return u=n,f="self",l=!0,!1;if(Z(n)){var e=M(n);if(r.indexOf(e)>-1)return u=e,f="self",_=!0,!1;r.push(e)}else if(r.indexOf(n)>-1)return u=n,f="self",_=!0,!1}),!(_||l||a||s)&&($(m,function(n,t){return e.test(n)?T.indexOf(n)>-1?(u=n,f="const",l=!0,!1):i.indexOf(n)>-1?(u=n,f="const",_=!0,!1):void 0:(u=n,f="const",p=!0,!1)}),!(_||l||a||s||p)&&void $(v,function(n,t){return N.indexOf(n)>-1?(u=n,f="static",l=!0,!1):c.indexOf(n)>-1?(u=n,f="static",_=!0,!1):void 0})))}),s?(o(n+" 类中的 ["+f+"] 成员名称不允许是："+u),!1):l?(o(n+" 类中的 ["+f+"] 成员名称不可是关键词："+u),!1):_?(o(n+" 类中的 ["+f+"]: "+u+" 是final类型不可覆写"),!1):a?(o(n+" 类中的 ["+f+"]: "+u+" 构造函数不允许设置为final类型！"),!1):!p||(o(n+" 类中的 ["+f+"]: "+u+" 名称必须[a-zA-Z0-9_$]方式命名"),!1)},Z=function(n){return 0===n.indexOf("$")},M=function(n){return n=0===n.indexOf("$")?n.replace("$",""):n},K=function(t,e,r,i,c,u){var f=["interface_name","lifetime_uid","toString"],a=/%self%/g,s=/%const%/g,l=/%static%/g,p=function(n){return n.replace(/[\s+]/g,"").replace(/\{(.*)\}/g,"{}")},_=function(n){return n.replace(/function\(/g,"(").replace(/\)/g,")=>")},d=function(n){var t=null,e=null;return a.test(n)?(t="self",e=n.replace(a,"")):s.test(n)?(t="const",e=n.replace(s,"")):l.test(n)&&(t="static",e=n.replace(l,"")),{type:t,name:e}},v=function(n){var t="",e=!1;switch(n.type){case"function":e=!0,t="function("+n.args.join(",")+"){}";break;case"object":e=!0,t="[object]";break;case"string":e=!0,t="[string]";break;case"number":e=!0,t="[number]";break;default:e=!1,t="[*]"}return{type:n.type,check:e,value:t}},m=function(n,t,e,r,i){var o=i.replace(/[\s+]/g,"");if(!n[t])return t+(o?"="+o:"");var c=n[t],u=c.toString(),f=C(c);if(r)switch(e){case"function":if("function"!==f)return t+(o?"="+o:"");if(p(i)!==p(u)||_(p(i))!==_(p(u)))return t+(o?"="+o:"");break;case"object":if("object"!==f)return t+(o?"="+o:"");break;case"string":if("string"!==f)return t+(o?"="+o:"");break;case"number":if("number"!==f)return t+(o?"="+o:"")}return null},y=function(n){return V()?n:_(n)};this.handle=function(){if(j(c))return!1;var a={},s=new function(){},l=null,p=null,_=null;return $(e,function(n,t){$(w(t,"self",{}),function(n,t){Z(n)&&(n=M(n)),a[n]=t})}),c=n(c)?c:[c],$(c,function(n,t){t.apply(s,[])}),$(s,function(n,t){if(f.indexOf(n)<0){var e=d(n),c=v(t),s=e.name,y=c.value,b=c.type,g=c.check;switch(e.type){case"self":if(N.indexOf(s)<0&&((l=m(a,s,b,g,y))&&(l=m(u,s,b,g,y)),l))return!1;break;case"const":if(T.indexOf(s)<0&&(_=m(r,s,b,g,y)))return!1;break;case"static":if(p=m(i,s,b,g,y))return!1;break;default:o("非法定义的接口体")}}}),l&&o(t+"的类必须实现接口: self."+y(l)),_&&o(t+"的类必须实现接口: const."+y(_)),p&&o(t+"的类必须实现接口: static."+y(p)),a=s=null,!0}},D=function(n,t,e){var r=this,i=t,o={},c={},u={},f={},a={};r.setConst=function(n){return d(n)&&(c=n)&&(u=m({},c)),r},r.setStatic=function(n){return d(n)&&(f=n)&&(a=m({},f)),r},r.handle=function(){return $(i,function(n,t){var r={};r="const"===e?t.const:"static"===e?t.static:t.prototype,j(r)||(o[t.class_name]=r)}),c=m(c,u),f=m(f,a),$(o,function(t,e){return $(e,function(t,e){n[t]=e}),!0}),o={},c={},u={},f={},a={},n}},R=function(t,e,r,c){var u=/^[A-Z][A-Za-z0-9_]+$/g,f="function(?,?){}";t||o("没有给定类名"),i(t)||o("类名必须是string类型: "+t),u.test(t)||o("类命名定义不规范,必须是以大写字母开头: "+t),e||o("没有定义类结构体: "+t),l(e)||o("类结构体必须是function类型: "+t);var a=e.toString().replace(/[\s+]/g,"").replace(/\{(.*)+\}$/g,"{}").replace(/\((.*)\)/g,"(?,?)");return f!==a&&o("类结构体定义不规范，必须是 "+f+" 格式: "+t),r&&(l(r)||o("类继承的结构体必须是function类型:"+t),(j(r.class_name)||j(r.lifetime_uid)||j(r._vd_)||j(r._vd_.getLifetimeCode(E())))&&o("类继承的结构体不规范:"+t),l(r)||o("类继承的结构体不规范，必须是 "+f+" 格式:"+t)),c&&(c=n(c)?c:[c],$(c,function(n,e){l(e)||o("接口的结构体必须是function类型: "+t),(j(e.interface_name)||j(e.lifetime_uid)||j(e._vd_)||j(e._vd_.getLifetimeCode(E())))&&o("接口的结构体不规范: "+t),l(e)||o("接口的结构体不规范，必须是 "+f+" 格式: "+t)})),!0},B=function(n){return'function(GV, oSupers, oCallSupersConstruct, oSupersConstructList){ oSupers["_construct"] = function(){ if(oCallSupersConstruct.indexOf(\''+n+"') > -1 ){ GV.oConsole.exit(\"构造函数只允许在创建对象时调用！\");} oCallSupersConstruct.push('"+n+"'); oSupersConstructList['"+n+"'].apply(this, arguments); }}"},H=function(n,t,e){var r={0:{}},i=[0],o={},c=0,u=e,f={},a=m({},n.oStatic);x(n.oConstructorList,function(e,u){var a={},s=r[c],_={},d={},v={},m=function(){var n=this;$(d,function(t,e){n[t]=e})};u.apply(t,[t,I(n.oConst),n.oStatic,L(s),_]),e>0&&u.apply(a,[a,I({}),L({}),L(s),{}]),c++,$(a,function(e,r){if(l(r))if("_construct"===e)o[c]=t[e],p(B(c))(n,d,i,o);else{var u=M(e);t.propertyIsEnumerable(e)&&(d[u]=t[e])}}),$(s,function(n,t){s.propertyIsEnumerable(n)&&!d[n]&&(d[n]=t)}),$(f,function(n,t){$(t,function(n,t){v[n]=t})}),$(_,function(t,e){var r=M(t);v[r]=e,n.oPrototype[r]=e}),m.prototype=v,r[c]=new m,f[c]=_}),$(t,function(n,e){Z(n)&&(Object.defineProperty(t,M(n),{value:e,writable:!1,enumerable:!0,configurable:!1}),delete t[n])}),n.oStatic=m(n.oStatic,a),t._construct&&(t._construct.apply(t,u),delete t._construct),$(r,function(n,t){n=parseInt(n),i.indexOf(n)<0&&i.push(n)}),f=null},q=function(n){return"function(LV, GV){\n            if(GV.oFunctions.isFunction(GV.oPrototype['"+n+"'])){            \n              LV['"+n+"'] = function (){\n              var sl = this, \n              fn = GV.oFunctions.proxyApplyFunc(GV.oPrototype['"+n+"'], \n              GV.oArrays.convertArgsToArray(arguments), sl); \n              return (fn && fn());}\n            }else{\n              LV['"+n+"'] = GV.oPrototype['"+n+"'];\n            }\n          }"},Q=function(n,t){x(n.oConstructorList,function(n,e){var r=new e;$(r,function(n,e){t[n]=e})}),$(n.oSelf,function(n,e){t["%self%"+n]=e}),n.oConst&&$(n.oConst,function(n,e){t["%const%"+n]=e}),n.oStatic&&$(n.oStatic,function(n,e){t["%static%"+n]=e})},U=function(n){return E()+"@"+n},W=function(n){var t={};return t[n.lifetime_uid]=n.class_name,j(n.super_class_name)||(t=v(t,n.super_class_name)),function(n){if(j(n.lifetime_uid)||j(n._vd_)||j(n.class_name))return!1;var e=n._vd_.getLifetimeCode(E()),r="";return $(t,function(n,t){if(U(n)===e)return r=t,!1}),r===n.class_name}},X=function(n){var t=n.interface_name;return function(n){if(j(n.lifetime_uid)||j(n._vd_)||j(n.interface_name))return!1;var e=n._vd_.getLifetimeCode(E()),r="";return $(t,function(n,t){if(U(n)===e)return r=t,!1}),r===n.interface_name}},Y=function(n){var t=U(n.lifetime_uid),e=n.interface_name;return function(n){if(j(n.lifetime_uid)||j(n._vd_)||j(n.interface_name))return!1;var r="",i=n.interface_name;return $(i,function(n,e){if(U(n)===t)return r=e,!1}),e===r}},nn=function(n){return function(t){var e=[];return t===E()&&(e=j(n)?[]:n),e}},tn=function(n){return function(t){var e=n;return t===E()&&(e=U(n)),e}},en=function(n){return function(t){var e=[];return t===E()&&(e=j(n)?null:n),e}},rn=function(n,t){return function(){return n+"@"+t}},on=function(n){var t=[];return x(n,function(n,e){var r={},i={},o={},c={};e.apply(r,[r,c,o,L({}),i]),t.push({class_name:e.class_name,self:r,prototype:i,static:o,const:c})}),t},cn=function(t,e,i,o){var c={},u={},f={},a=[],l={},d={},m={},y={oKlass:f,oConst:m,oStatic:d,oConstructorList:e,oPrototype:l,oConsole:s,handler:H},g=e,h=i,O=z(),S=function n(t,e){if("INTERFACE"===e?b(c,t.lifetime_uid)||(c[t.lifetime_uid]=t.interface_name):b(u,t.lifetime_uid)||(u[t.lifetime_uid]=t.class_name),t._vd_){var r=t._vd_.getSuper(E());!j(r)&&n(r,e)}},w="function (GV){\n           GV.oKlass = function "+t+"() {\n              GV.handler(GV, this, arguments);\n           };\n         }\n       ";if(!R(t,e,i,o))return!1;if(o=n(o)?o:j(o)?[]:[o],o=new P(o,h).handle(),e.class_name=g.class_name=t,e.lifetime_uid=g.lifetime_uid=O,e.interface_name=g.interface_name=c,e=[e],i="function"===C(i)?i.prototype:{},e=new F(e,h).handle(),j(o)||$(o,function(n,t){S(t,"INTERFACE")}),$(e,function(n,t){n>0&&S(t,"CLASS")}),a=on(e),!J(t,a))return!1;m=new D(m,a,"const").handle(),d=new D(d,a,"static").setConst(m).handle(),l=new D(l,a,"class").setConst(m).setStatic(d).handle();var x=function(){this.class_name=t,this.super_class_name=u,this.interface_name=c,this.lifetime_uid=O,this.instanceOfClass=W(this),this.instanceOfInterface=X(this),this.toString=rn(O,t),this._vd_=L({getLifetimeCode:tn(O)})},I=function(){var n=this,t=[];$(l,function(e,i){Z(e)&&(e=M(e),t.push(e)),"_construct"!==e&&p(q(e))(n,{oArrays:r,oFunctions:_,oPrototype:l})}),$(n,function(e,r){t.indexOf(e)>-1&&Object.defineProperty(n,e,{value:r,writable:!1,enumerable:!0,configurable:!1})}),t=[]};return x.prototype=i,I.prototype=new x,y.oConstructorList=e,p(w)(y),f=y.oKlass,f.constructor=g,f.prototype=new I,f.static=d,f.class_name=t,f.super_class_name=u,f.interface_name=c,f.lifetime_uid=O,f.instanceOfClass=W(f),f.instanceOfInterface=X(f),f.toString=rn(O,t),f._vd_=L({getInterfaces:nn(o),getLifetimeCode:tn(O),getSuper:en(h)}),f=v(f,m),new K(t,a,m,d,o,l).handle(),L(f)},un=function(n,t){var e=function n(t,e){if(!e&&"function"!==C(e))return t;if(t=t.concat(e.constructor||e),e._vd_){var r=e._vd_.getSuper(E());if(!j(r))return n(t,r)}return t};this.handle=function(){return e(n,t)}},fn=function(n){var t=null;return $(n,function(n,e){if("InterfaceType"!==e.name)return t=n,!1}),t},an=function(n,t,e,r,c){var u=/^[A-Z][A-Za-z0-9_]+$/g,f=/^[A-Z_$]+$/i,a=[],s=!1,p=!1,_="",v=!1,m=!1;if(n||o("没有给定接口名"),i(n)||o("接口名必须是string类型: "+n),u.test(n)||o("接口命名定义不规范,必须是以大写字母开头: "+n),t){d(t)||o("接口self结构体必须是object类型: "+n),y(t)||o("接口self结构体必须是{}格式: "+n);var b=fn(t);if(b&&o("接口self结构体的值类型不合法，必须是InterfaceType类型: "+n+" -> "+b),"{}"!==JSON.stringify(t).replace(/[\s+]/g,"").replace(/\{(.*)\}/g,"{}")&&o("接口self结构体不规范，必须是 {} 格式: "+n),$(t,function(n,t){if("$_construct"===n)return _=n,p=!0,!1;if(N.indexOf(n)>-1)return _=n,s=!0,!1;if(Z(n)){var e=M(n);if(a.indexOf(e)>-1)return _=e,v=!0,!1;a.push(e)}else if(a.indexOf(n)>-1)return _=n,v=!0,!1}),s)return o(n+" 接口中self定义的名称不可使用关键："+_),!1;if(p)return o(n+" 接口中self的 "+_+" 构造函数不允许设置为final类型！"),!1;if(v)return o("接口self结构体定义的名称已存在："+_),!1}if(r){d(r)||o("接口static的结构体必须是object类型: "+n),y(r)||o("接口static结构体必须是{}格式: "+n),"{}"!==JSON.stringify(r).replace(/[\s+]/g,"").replace(/\{(.*)\}/g,"{}")&&o("接口static的结构体定义不规范，必须是 {} 格式: "+n);var g=fn(r);g&&o("接口static结构体的值类型不合法，必须是InterfaceType类型: "+n+" -> "+g)}if(e){d(e)||o("接口const的结构体必须是object类型: "+n),y(e)||o("接口const结构体必须是{}格式: "+n),"{}"!==JSON.stringify(e).replace(/[\s+]/g,"").replace(/\{(.*)\}/g,"{}")&&o("接口const的结构体定义不规范，必须是 {} 格式: "+n);var h=fn(e);if(h&&o("接口const结构体的值类型不合法，必须是InterfaceType类型: "+n+" -> "+h),$(e,function(n,t){return f.test(n)?T.indexOf(n)>-1?(_=n,s=!0,!1):void 0:(_=n,m=!0,!1)}),s)return o(n+" 接口中Const定义的名称不可使用关键："+_),!1;m&&o(n+" 接口中Const定义的名称必须全部以大写命名："+_)}return c&&(l(c)||o("接口继承的结构体必须是function类型: "+n),(j(c.interface_name)||j(c.lifetime_uid)||j(c._vd_)||j(c._vd_.getLifetimeCode(E())))&&o("接口继承的结构体定义不规范: "+n),l(c)||o("接口继承的结构体定义不规范，必须是 function(?,?){} 格式: "+n)),a=[],!0},sn=function(n,t,e,r,i){var o=[],c=d(t)?t:{},u={},f={oInterface:u,oConstructorList:o,handler:Q,oStatic:r,isStaticHandle:!1,oConst:e,oSelf:c},a=i,s=z(),l="function(GV){\n      GV.oInterface = function "+n+"() {\n        GV.handler(GV, this);\n      };\n    }";if(!an(n,c,e,r,i))return!1;o=new un(o,a).handle();var _=function(){this.interface_name=n,this.lifetime_uid=s,this.toString=rn(s,n)};return f.oConstructorList=o,p(l)(f),u=f.oInterface,u.constructor=u,u.interface_name=n,u.prototype=new _,u.lifetime_uid=s,u.instanceOfClass=Y(u),u.toString=rn(s,n),u._vd_=L({getLifetimeCode:tn(s),getSuper:en(a)}),Object.freeze(u)},ln=function(n,t){this.name="InterfaceType",this.type=n,this.args=t},pn={function:function(){var n=[];return $(arguments,function(t,e){n.push(e)}),Object.freeze(new ln("function",n))},objects:function(){return Object.freeze(new ln("object",""))},string:function(){return Object.freeze(new ln("string",""))},number:function(){return Object.freeze(new ln("number",""))},all:function(){return Object.freeze(new ln("all",""))}},_n=function(n,t,e,r){return new cn(n,t,e,r)},dn=function(n,t,e,r,i){return new sn(n,t,e,r,i)};!function(){return"function"==typeof Object.defineProperty}()?o("当前版本不支持JsKlass，请使用IE8版本以上的平台"):Object.defineProperty(window,"JsKlass",{value:L({DefClass:L(_n),DefInterface:L(dn),InterfaceType:L(pn),Global:{}}),writable:!1,enumerable:!1,configurable:!1})});
